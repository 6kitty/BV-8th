---
layout: post
title: "XMR의 암호화 기술"
categories:
  - Blockchain
tags:
  - privacy coin
last_modified_at: 2025-10-17
---

# 모네로

비트코인은 투명성, 익명성을 제공한다. 실제로도 그럴까? 그렇다면 최근 일어나는 비트코인 추적과 몰수는 어떻게 일어나는 것일까? 엄밀하게 말하자면 비트코인은 익명성보다는 가명성을 띈다는 것이 맞는 표현일지도 모르겠다. 모든 거래 세부 사항이 투명한 블록체인에서 작동하고 휴리스틱 하지만, 자금 흐름 추적이 거의 가능하며 실제 신원 확인도 가능하다. 

이에 반해 모네로는 비트코인보다 더 익명성을 보장한다. 모든 거래가 비공개되며 송신자, 수신자, 거래 금액까지 알 수 없다. 

모네로는 untraceability, unlinkability를 제공한다. 

그리고 이것을 가능케 하는 ring signatures, stealth addresses, confidential transactions, Dandelion++이 있다. 

---

1. 링 서명 
: 송금자의 거래+여러개의 디코이를 묶어서 진짜 자금 출처를 알기 어렵게 한다. 

2. RingCT 
: 전송되는 XMR 금액을 숨긴다. 

3. 스텔스 주소 
: 단 한 번만 사용하는 공개 주소 

짧게 언급하여 지캐시와 다른 점은 모네로의 경우, 다층적으로 프라이버시를 구현한다는 점이다. 또한, ZKP 구현을 위한 trusted setup이 필요하지 않다. 거래의 유효성을 sk-SNARKs로 구현하는 지캐시와는 다르게 이미 모든 거래를 프라이빗하게 하므로 더 익명성이 보장된다고 할 수 있다. 

또한, 노선 자체가 지캐시는 조금 더 메인스트림이고, 모네로는 여러가지 규제 핍박을 받는.. 코인이라서 방향도 조금 다르다고 할 수 있다. 

각 암호화 기술에 대해 자세히 살펴보자. 

# Ring 서명 (송신자 익명화)

![ring signature](../../../assets/images/251018_01.png)

다수의 공개키(이중 실제 서명자의 키도 포함) -> 하나의 서명 생성 
Ring 집합 안에서 무작위화된 서명 구조 -> 추적 불가능성 

다른 서명 기술과 달리 plausible denialbility을 제공한다. 

# Ring CT (거래 금액 은닉)

Monero는 비트코인과 유사한 UTXO 모델로 운영되는데, 비트코인은 UTXO 잔액이 공개적인 것에 반해 Monero는 이를 Pedersen Commitments로 대체한다. 이부분이 Ring CT의 핵심 요소이다. 

CT는 confidential Transactions의 약자이다. 거래 금액을 숨기고 비공개 거래를 가능하게 하는 암호화 기술을 말한다.  

모든 입력 및 출력 약속(원문 보기) 합계가 일치하면 거래는 유효하다. 이렇게 네트워크를 유효성을 확인하면서도 실제 잔액은 공개하지 않을 수 있다. 

키를 보유한 송신자, 수신자만 실제 금액을 확인할 수 있다. bob이 alice에게 3개의 XMR을 보낸다고 하면.. 

![Ring CT](../../../assets/images/251018_02.png)

1. 해당 금액은 Pedersen Commitment를 사용하여 숨김 처리된다. 
2. 실제 금액 3 XMR에 58 같은 비밀 난수를 추가한다. 
3. 이때 약속된 합계는 61이다. 이 합계는 모네로 네트워크에 브로드캐스트된다. 

# 스텔스 주소 (수신자 익명화)

송신자는 Monero를 수신자의 공개 주소로 direct 보내지 않는다. 수신자의 공개 보기 키? 공개 지출 키? + 송신자만 아는 임의의 값 
-> 이것을 사용하여 일회성 destination key를 생성한다.

# Dandelion++ 

2020년 4분기에 도입된 네트워크상 프라이버시 보장 기술이다. 기능은 송신자의 IP주소가 전체 network에 브로드캐스트 되지 않도록 한다. Monero 유저가 VPN이나 tor를 사용하지 않으면 모네로 노드는 user의 IP, metadata 등을 캡처하여 은닉할 수 있다? (뭔소리지 이부분) 

Dandelion++은 다음 두 step으로 나뉜다. 

1. STEM phase 
: 새로 생성한 트랜잭션을 임시로 맡을 STEM node로 전송하는 단계 

2. FLUFF phase 
: STEM node에 있는 트랜잭션에 IP 주소가 숨겨져 있는지 확인하고 만약 IP 주소가 공개되어 있다면 STEM node의 IP 주소로 덮은 후 브로드캐스트하는 단계. 주소뿐 아니라 거래 지점도 모호하게 만든다. 

# 모네로의 한계 

프라이버시 코인을 추적하기 위한 기술 개발이 계속 진행되고 있다. 2020년에는 미국 정부가 Chainalysis에 모네로 추적 기술 개발 계약을 62만 달러 포상금과 함께 체결했다. 당시 기술은 네트워크 사이 진입, 이탈 지점에서 파악하는 거래 추적에 중점을 두었다. 

2021년에는 Coindesk가 밝히길, Chainalysis는 단서 수집을 위해 IP 주소를 비밀리에 기록하는 Walletexplorer.com을 운영하였다고 한다. 

이 기술을 통해 신원 노출된 사용자와 크립토 거래를 연결할 수 있었고, 수집한 IP 주소를 리버싱하여 관련한 비트코인 주소도 파악 가능했다고 한다. 